function PA = RieszPostfilter(A, residual, config)% RIESZPOSTFILTER combine a 3D low frequency image with a high frequency image%% PA = RieszPostfilter(A, residual, config)% combine a 3D low frequency image with a high frequency image%% Input:% ------%   - A : a 3D low frequency image%   - residual : a 3D high frequency image%   - config : a RieszConfig object% A is processed with the lowpass prefilter object in config, while% residual is processed with the highpass counterpart.%% Output:% -------%   - PA : 3D image obtained by combining the A and residual after%   filtering.%% -------------------------------------------------------------------------%%  AUTHOR:%    Nicolas Chenouard, nicolas.chenouard@gmail.com%    Ecole Polytechnique Federale de Lausanne%% -------------------------------------------------------------------------%%  REFERENCE:%    N. Chenouard, M. Unser, "3D Steerable Wavelets in practice",%   IEEE Transactions on Image Processing,%   Vol. 21, Num. 11, pp 4522--4533, Nov 2012%% -------------------------------------------------------------------------%%  VERSION:%  v0.3, 18.11.2012%%  Riesz-3D-light toolboxif config.prefilterType == PrefilterType.None,    PA = A;else    if (~config.spatialDomainStorage)        PA = A.*config.prefilter.filterLow + fftn(residual).*config.prefilter.filterHigh;    else        FA = fftn(A).*config.prefilter.filterLow + fftn(residual).*config.prefilter.filterHigh;        PA = ifftn(FA);        if strcmp(config.dataType, 'real')            PA = real(PA);        end    end;end