function [PA residual] = RieszPrefilter(A, config)% RIESZPREFILTER process a 3D image with high pass and low pass filters%% [PA residual] = RieszPrefilter(A, config)% filter the 3D image A with the lowpass and highpass prefilters specified% by the RieszConfig object config.% Returns a 3D low frequency image PA, and a high frequency image 'residual'%% -------------------------------------------------------------------------%%  AUTHOR:%    Nicolas Chenouard, nicolas.chenouard@gmail.com%    Ecole Polytechnique Federale de Lausanne%% -------------------------------------------------------------------------%%  REFERENCE:%    N. Chenouard, M. Unser, "3D Steerable Wavelets in practice",%   IEEE Transactions on Image Processing,%   Vol. 21, Num. 11, pp 4522--4533, Nov 2012%% -------------------------------------------------------------------------%%  VERSION:%  v0.3, 18.11.2012%%  Riesz-3D-light toolboxif config.prefilterType == PrefilterType.None,    PA = A;    residual = [];else    if config.spatialDomainStorage,        FA = fftn(A);        PA = ifftn(FA.*config.prefilter.filterLow);        residual = ifftn(FA.*config.prefilter.filterHigh);        if strcmp(config.dataType, 'real')            PA = real(PA);            residual = real(residual);        end    else        PA = A.*config.prefilter.filterLow;        residual = A.*config.prefilter.filterHigh;    endend