function PA = RieszPostfilter(A, residual, config)% RIESZPOSTFILTER combine a 3D low frequency image with a high frequency image%% PA = RieszPostfilter(A, residual, config)% combine a 3D low frequency image with a high frequency image%% Input:% ------%   - A : a 3D low frequency image%   - residual : a 3D high frequency image%   - config : a RieszConfig object% A is processed with the lowpass prefilter object in config, while% residual is processed with the highpass counterpart.%% Output:% -------%   - PA : 3D image obtained by combining the A and residual after%   filtering.%% -------------------------------------------------------------------------%%  AUTHOR:%    Nicolas Chenouard, nicolas.chenouard?epfl.ch%    Ecole Polytechnique Federale de Lausanne%% -------------------------------------------------------------------------%%  VERSION:%  v0.1, 20.07.2011%%  Riesz-3D-light toolboxif config.prefilterType == PrefilterType.None,    PA = A;else    if (~config.spatialDomainStorage)        PA = A.*config.prefilter.filterLow + fftn(residual).*config.prefilter.filterHigh;    else        FA = fftn(A).*config.prefilter.filterLow + fftn(residual).*config.prefilter.filterHigh;        PA = ifftn(FA);        if strcmp(config.dataType, 'real')            PA = real(PA);        end    end;end